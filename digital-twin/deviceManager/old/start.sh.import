. ../testPerformanceTools.sh
. ${HOME}/env.import

## DEFINIITION OF THE DEFAULT TEST SERVER CONFIGURATION
DEFAULTSERVERNAME="TESTSERVER"
DEFAULTSERVERIP="127.0.0.1"
DEFAULTSERVERPORT="7777"
DEFAULTSERVERPOLLINTERVAL="0.5"
# PATH OF THE FILE OF THE SERVER TO EXECUTE FROM TEST FILE
DEFAULTSERVERPATH="../../BaseServersManager.py"

## DEFINITION OF THE TEST SERVER LOG OUTPUT PATHS
SERVERSLOGSPATH="logs/servers"
SERVERSRESULTSPATH="logs/servers/results"
SERVERSERRORLOGSPATH="logs/servers/errors"

DEFAULTRESULTSFILE="results/${DEFAULTSERVERNAME}.log"
DEFAULTERRORFILE="results/${DEFAULTSERVERNAME}errors.log"
DEFAULTPERFORMANCEFILE="results/${DEFAULTSERVERNAME}performance.log"
## DEFINITION OF THE CAMERAS LOG OUTPUT PATHS
LOGSPATH="logs"
ERRORLOGSPATH="logs/errors"

SERVERPARAMS="-ip $DEFAULTSERVERIP -port $DEFAULTSERVERPORT" 

CLIENTPERFORMANCEFILE="logs/camerasperformance.log"
## DEFINITION OF THE START FILE OF THE TESTS
TESTINITFILE="startTest.sh"

SERVERSAVELOGPATH="$SERVERSLOGSPATH/$DEFAULTSERVERNAME.log"
CLIENTRESULTFILE="$LOGSPATH/results"
CLIENTERRFILE="$ERRORLOGSPATH/errors"

function startTestServer(){

  if [ -z $3 ] && [ -z $4 ] && [ -z $5 ];
  then
    py $DEFAULTSERVERPATH -n $DEFAULTSERVERNAME -ip $DEFAULTSERVERIP -port $DEFAULTSERVERPORT -pool $DEFAULTSERVERPOLLINTERVAL \
    1> $1\
    2> $2 &\
    echo "Test Server Open on PID ${PID}"
  elif [-z $4 ] && [ -z $5 ];
  then
    echo "You must indicate a number of objective"
  else
    py $DEFAULTSERVERPATH -t "$3" -oC $4 -oM $5 -n $DEFAULTSERVERNAME -ip $DEFAULTSERVERIP -port $DEFAULTSERVERPORT -pool $DEFAULTSERVERPOLLINTERVAL \
    1> $1\
    2> $2 &\
    echo "Test Server Open on PID ${PID}"
  fi

}