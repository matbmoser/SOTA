#!/usr/bin/env bash

. config.import

function getPythonFilePID(){
    echo "$(ps -ef | grep "python3" | grep ${1} | awk {'print$2'})"
}

function openDefaultServer(){
    mkdir -p ./log 
    mkdir -p ./log/err
    PID=$(getPythonFilePID ${DEFAULTSERVERFILENAME})
    if [ -z "$PID" ];
    then
        echo "Starting Server on PID $!"
        python3 $DEVICE_MANAGER/$DEFAULTSERVERFILENAME 1> log/${1} 2> log/err/${1} & tail -f log/${1}
    else
        echo "[ERROR] Server is Already Running on PID=[$PID]"
    fi

}

function closeServer(){
    mkdir -p ./log 
    mkdir -p ./log/err
    PID=$(getPythonFilePID ${DEFAULTSERVERFILENAME})
    if [ -z "$PID" ];
    then
        echo "The default Server is not running at the moment on PID $PID"
    else
        echo "Closing default server"
        kill -9 $PID 1>> log/${1} 2>> log/err/${1}
    fi

}

function openServer(){
    python3 "${DEVICE_MANAGER}/${SERVERFILENAME}" -n ${1} -ip ${2} -port ${3} 
}